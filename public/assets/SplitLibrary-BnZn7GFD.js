import{r as i,j as e,a as w,A as _}from"./index-BYZoeFiF.js";import{S as $}from"./SuperAdminSidebar-w5hGfztw.js";import{E as P}from"./ExerciseCard-CXk6ElDL.js";import"./index-D-5OJeWc.js";const z=({split:m,onClose:d})=>{const[u,p]=i.useState(null),g=m.days||[];return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 z-50 flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-3xl w-full max-h-[80vh] overflow-y-auto p-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-black mb-4",children:[m.split_name," Details"]}),g.length===0?e.jsx("p",{children:"No days found for this split."}):g.map(n=>e.jsxs("div",{className:"border-b border-gray-200 py-2",children:[e.jsxs("h3",{className:"font-semibold",children:["Day ",n.day_number,": ",n.day_title]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:n.exercises&&n.exercises.length>0?n.exercises.map(h=>e.jsx("button",{onClick:()=>p(h),className:"bg-black text-white px-3 py-1 rounded text-sm hover:bg-[#4b12c9]",children:h.name},h.id)):e.jsx("p",{className:"text-sm italic",children:"No exercises"})})]},n.id||n.day_number)),e.jsx("button",{className:"mt-6 px-4 py-2 bg-black text-white rounded",onClick:d,children:"Close"}),u&&e.jsx(P,{exercise:u,onClose:()=>p(null)})]})})},B=({isOpen:m,onClose:d,onSplitAdded:u})=>{const[p,g]=i.useState([]),[n,h]=i.useState(!1),[b,o]=i.useState(""),[j,y]=i.useState(1),[s,c]=i.useState({split_name:"",target_gender:"unisex",num_days:1,days:[]}),[C,f]=i.useState({}),[S,N]=i.useState({});i.useEffect(()=>{m&&(v(),F())},[m]);const v=async()=>{try{const a=await w.get(`${_}/api/exercises`);g(a.data)}catch{o("Failed to load exercises")}},F=()=>{y(1),c({split_name:"",target_gender:"unisex",num_days:1,days:[]}),f({}),N({}),o("")},E=a=>{const{name:r,value:l}=a.target;c(t=>({...t,[r]:l}))},L=()=>{if(!s.split_name.trim()){o("Please enter a split name");return}const a=Array.from({length:s.num_days},(t,x)=>({day_title:`Day ${x+1}`,exercises:[]}));c(t=>({...t,days:a}));const r={},l={};for(let t=0;t<s.num_days;t++)r[t]="",l[t]="";f(r),N(l),y(2)},A=(a,r)=>{c(l=>({...l,days:l.days.map((t,x)=>x===a?t.exercises.find(k=>k.id===r.id)?{...t,exercises:t.exercises.filter(k=>k.id!==r.id)}:{...t,exercises:[...t.exercises,{...r,sets:3,reps:"8-12",rest_time:"60",notes:""}]}:t)}))},D=a=>{let r=p;const l=C[a];l&&(r=r.filter(x=>x.muscle_group===l));const t=S[a];return t&&(r=r.filter(x=>x.name.toLowerCase().includes(t.toLowerCase()))),r},M=async()=>{if(s.days.some(a=>a.exercises.length===0)){o("Each day must have at least one exercise");return}try{h(!0),o("");const a={split_name:s.split_name,target_gender:s.target_gender,workout_days:s.days.length,days:s.days.map((r,l)=>({day_number:l+1,day_title:r.day_title,exercise_ids:r.exercises.map(t=>t.id),exercise_details:r.exercises.map(t=>({exercise_id:t.id,sets:t.sets,reps:t.reps,rest_time:t.rest_time,notes:t.notes}))}))};await w.post(`${_}/api/splits`,a),u==null||u(),d()}catch{o("Failed to create split")}finally{h(!1)}};return m?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-30 z-50 p-4",onClick:d,children:e.jsxs("div",{className:"bg-white p-6 rounded-md shadow-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Add New Split"}),e.jsx("button",{onClick:d,className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-md mb-4 text-sm",children:b}),j===1&&e.jsxs("form",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",name:"split_name",placeholder:"Split Name",value:s.split_name,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-1 focus:ring-blue-500 focus:border-blue-500",required:!0}),e.jsxs("select",{name:"target_gender",value:s.target_gender,onChange:E,className:"w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"unisex",children:"Unisex"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]}),e.jsx("input",{type:"number",name:"num_days",value:s.num_days,onChange:a=>c(r=>({...r,num_days:Math.max(1,Math.min(7,parseInt(a.target.value)||1))})),min:"1",max:"7",className:"w-full p-2 border border-gray-300 rounded-md text-xs focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"border px-3 py-1.5 rounded-md text-sm font-medium hover:bg-gray-100",onClick:d,children:"Cancel"}),e.jsx("button",{type:"button",className:"bg-blue-500 text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-blue-600 transition-colors",onClick:L,children:"Next"})]})]}),j===2&&e.jsxs("div",{className:"space-y-4",children:[s.days.map((a,r)=>e.jsxs("div",{className:"bg-gray-50 p-3 rounded-md border",children:[e.jsx("input",{type:"text",value:a.day_title,onChange:l=>{const t=[...s.days];t[r].day_title=l.target.value,c({...s,days:t})},className:"w-full mb-2 p-2 border-b border-gray-300 focus:outline-none focus:border-blue-500 text-xs font-medium"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-col gap-2 max-h-36 overflow-y-auto border rounded-md p-2",children:D(r).map(l=>{const t=!!a.exercises.find(x=>x.id===l.id);return e.jsxs("label",{className:`flex items-center space-x-2 p-2 rounded-md cursor-pointer text-xs transition-colors ${t?"bg-blue-100 border-blue-300":"hover:bg-gray-100 border-gray-200"}`,children:[e.jsx("input",{type:"checkbox",checked:t,onChange:()=>A(r,l),className:"rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"truncate",children:l.name}),e.jsx("div",{className:"text-gray-500 text-[10px]",children:l.muscle_group})]})]},l.id)})})]},r)),e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"border px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-100",onClick:()=>y(1),children:"Back"}),e.jsx("button",{type:"button",className:"border px-4 py-2 rounded-md text-sm font-medium hover:bg-gray-100",onClick:d,children:"Cancel"}),e.jsx("button",{onClick:M,disabled:n,className:"bg-blue-500 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-600 disabled:opacity-50",children:n?"Creating...":"Create Split"})]})]})]})}):null},Y=()=>{const[m,d]=i.useState([]),[u,p]=i.useState(!1),[g,n]=i.useState(null),[h,b]=i.useState(!0),o=async()=>{try{b(!0);const s=await w.get(`${_}/api/splits`);console.log("âœ… Splits response:",s.data),Array.isArray(s.data)?d(s.data):(console.warn("âš ï¸ Expected array, got:",s.data),d([]))}catch(s){console.error("Failed to fetch splits:",s),d([])}finally{b(!1)}};i.useEffect(()=>{o()},[]);const j=()=>{o()},y=async s=>{if(window.confirm("Are you sure you want to delete this split?"))try{await w.delete(`${_}/api/splits/${s}`),o()}catch(c){console.error("Failed to delete split:",c),alert("Failed to delete split. Please try again.")}};return e.jsxs("div",{className:"flex min-h-screen bg-gray-50",children:[e.jsx($,{}),e.jsxs("div",{className:"flex-1 p-5",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"Split Library"}),e.jsx("p",{className:"text-[11px] text-gray-600",children:"Create and manage workout splits for your clients"})]}),e.jsx("div",{className:"mb-3",children:e.jsx("button",{className:"bg-blue-600 text-white px-3 py-1.5 rounded-md hover:bg-blue-700 transition-colors text-xs font-medium w-full sm:w-auto",onClick:()=>p(!0),children:"+ Create New Split"})}),h?e.jsx("div",{className:"flex justify-center items-center py-6",children:e.jsx("div",{className:"text-gray-500 text-xs",children:"Loading splits..."})}):m.length===0?e.jsxs("div",{className:"bg-white rounded border p-5 text-center text-xs",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ‹ï¸"}),e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"No splits created yet"}),e.jsx("p",{className:"text-gray-600 mb-3",children:"Create your first workout split to get started"}),e.jsx("button",{className:"bg-blue-600 text-white px-3 py-1.5 rounded-md hover:bg-blue-700 transition-colors text-xs font-medium",onClick:()=>p(!0),children:"Create Your First Split"})]}):e.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(210px,1fr))] gap-1 justify-center",children:m.map(s=>{var f;const c=s.workout_days||(s.days?s.days.length:0),C=(f=s.days)==null?void 0:f.reduce((S,N)=>{var v;return S+(((v=N.exercises)==null?void 0:v.length)||0)},0);return e.jsxs("div",{className:"bg-white rounded-md border p-1.5 hover:shadow transition-shadow text-[11px] space-y-1 max-w-[230px]",children:[e.jsx("h3",{className:"font-semibold text-gray-900 line-clamp-2 mb-1",children:s.split_name}),e.jsxs("div",{className:"space-y-1 mb-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-700",children:"Days:"}),e.jsx("span",{className:"text-gray-900",children:c})]}),s.days&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-700",children:"Exercises:"}),e.jsx("span",{className:"text-gray-900",children:C})]})]}),e.jsxs("div",{className:"flex gap-0.5 border-t pt-1.5",children:[e.jsx("button",{onClick:()=>n(s),className:"flex-1 bg-gray-100 text-gray-700 py-1 rounded hover:bg-gray-200 transition-colors font-medium",children:"View"}),e.jsx("button",{onClick:()=>handleEditSplit(s),className:"flex-1 bg-blue-600 text-white py-1 rounded hover:bg-blue-700 transition-colors font-medium",children:"Edit"}),e.jsx("button",{onClick:()=>y(s.id),className:"flex-1 bg-red-500 text-white py-1 rounded hover:bg-red-600 transition-colors font-medium",children:"Delete"})]})]},s.id)})})]}),e.jsx(B,{isOpen:u,onClose:()=>p(!1),onSplitAdded:j}),g&&e.jsx(z,{split:g,onClose:()=>n(null)})]})};export{Y as default};
